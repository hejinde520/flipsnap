/*!build time : 2013-12-12 3:28:57 PM*/
!function(a,b,c){function d(a,b){return this instanceof d?this.init(a,b):new d(a,b)}function e(a,b){return a.changedTouches?a.changedTouches[0][b]:a[b]}function f(a){return j(a,function(a){return k.style[a]!==c})}function g(a,b,d){var e=m[b];e?a[e]=d:a[b]!==c?(m[b]=b,a[b]=d):j(l,function(e){var f=i(e)+i(b);return a[f]!==c?(m[b]=f,a[f]=d,!0):void 0})}function h(a){if(k.style[a]!==c)return a;var b;return j(l,function(d){var e=i(d)+i(a);return k.style[e]!==c?(b="-"+d+"-"+a,!0):void 0}),b}function i(a){return a.charAt(0).toUpperCase()+a.substr(1)}function j(a,b){for(var c=0,d=a.length;d>c;c++)if(b(a[c],c))return!0;return!1}var k=b.createElement("div"),l=["webkit","moz","o","ms"],m={},n=d.support={},o=!1;n.transform3d=f(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]),n.transform=f(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"]),n.transition=f(["transitionProperty","WebkitTransitionProperty","MozTransitionProperty","OTransitionProperty","msTransitionProperty"]),n.addEventListener="addEventListener"in a,n.mspointer=a.navigator.msPointerEnabled,n.cssAnimation=(n.transform3d||n.transform)&&n.transition;var p=["touch","mouse","pointer"],q={start:{touch:"touchstart",mouse:"mousedown",pointer:"MSPointerDown"},move:{touch:"touchmove",mouse:"mousemove",pointer:"MSPointerMove"},end:{touch:"touchend",mouse:"mouseup",pointer:"MSPointerUp"}};n.addEventListener&&(b.addEventListener("gesturestart",function(){o=!0}),b.addEventListener("gestureend",function(){o=!1})),d.prototype.init=function(a,d){var e=this;if(e.element=a,"string"==typeof a&&(e.element=b.querySelector(a)),!e.element)throw new Error("element not found");return n.mspointer&&(e.element.style.msTouchAction="none"),d=d||{},e.distance=d.distance,e.maxPoint=d.maxPoint,e.disableTouch=d.disableTouch===c?!1:d.disableTouch,e.disable3d=d.disable3d===c?!1:d.disable3d,e.transitionDuration=d.transitionDuration===c?"350ms":d.transitionDuration+"ms",e.currentPoint=0,e.currentX=0,e.animation=!1,e.use3d=n.transform3d,e.disable3d===!0&&(e.use3d=!1),n.cssAnimation?e._setStyle({transitionProperty:h("transform"),transitionTimingFunction:"cubic-bezier(0,0,0.25,1)",transitionDuration:"0ms",transform:e._getTranslate(0)}):e._setStyle({position:"relative",left:"0px"}),e.refresh(),p.forEach(function(a){e.element.addEventListener(q.start[a],e,!1)}),e},d.prototype.handleEvent=function(a){var b=this;switch(a.type){case q.start.touch:case q.start.mouse:case q.start.pointer:b._touchStart(a);break;case q.move.touch:case q.move.mouse:case q.move.pointer:b._touchMove(a);break;case q.end.touch:case q.end.mouse:case q.end.pointer:b._touchEnd(a);break;case"click":b._click(a)}},d.prototype.refresh=function(){var a=this;a._maxPoint=a.maxPoint===c?function(){for(var b,c=a.element.childNodes,d=0,e=0,f=c.length;f>e;e++)b=c[e],1===b.nodeType&&d++;return d>0&&d--,d}():a.maxPoint,a._distance=a.distance===c?a.element.scrollWidth/(a._maxPoint+1):a.distance,a._maxX=-a._distance*a._maxPoint,a.moveToPoint()},d.prototype.hasNext=function(){var a=this;return a.currentPoint<a._maxPoint},d.prototype.hasPrev=function(){var a=this;return a.currentPoint>0},d.prototype.toNext=function(a){var b=this;b.hasNext()&&b.moveToPoint(b.currentPoint+1,a)},d.prototype.toPrev=function(a){var b=this;b.hasPrev()&&b.moveToPoint(b.currentPoint-1,a)},d.prototype.moveToPoint=function(a,b){var d=this;b=b===c?d.transitionDuration:b+"ms";var e=d.currentPoint;a===c&&(a=d.currentPoint),d.currentPoint=0>a?0:a>d._maxPoint?d._maxPoint:parseInt(a,10),n.cssAnimation?d._setStyle({transitionDuration:b}):d.animation=!0,d._setX(-d.currentPoint*d._distance,b),e!==d.currentPoint&&(d._triggerEvent("fsmoveend",!0,!1),d._triggerEvent("fspointmove",!0,!1))},d.prototype._setX=function(a,b){var c=this;c.currentX=a,n.cssAnimation?c.element.style[m.transform]=c._getTranslate(a):c.animation?c._animate(a,b||c.transitionDuration):c.element.style.left=a+"px"},d.prototype._touchStart=function(a){var c=this;c.disableTouch||c._eventType||o||(j(p,function(b){return a.type===q.start[b]?(c._eventType=b,!0):void 0}),c.element.addEventListener(q.move[c._eventType],c,!1),b.addEventListener(q.end[c._eventType],c,!1),"mouse"===c._eventType&&a.preventDefault(),n.cssAnimation?c._setStyle({transitionDuration:"0ms"}):c.animation=!1,c.scrolling=!0,c.moveReady=!1,c.startPageX=e(a,"pageX"),c.startPageY=e(a,"pageY"),c.basePageX=c.startPageX,c.directionX=0,c.startTime=a.timeStamp,c._triggerEvent("fstouchstart",!0,!1))},d.prototype._touchMove=function(a){var b=this;if(b.scrolling&&!o){var c,d,f,g,h=e(a,"pageX"),i=e(a,"pageY");if(b.moveReady){a.preventDefault(),a.stopPropagation(),c=h-b.basePageX,d=b.currentX+c,(d>=0||d<b._maxX)&&(d=Math.round(b.currentX+c/3)),b.directionX=0===c?b.directionX:c>0?-1:1;var j=!b._triggerEvent("fstouchmove",!0,!0,{delta:c,direction:b.directionX});j?b._touchAfter({moved:!1,originalPoint:b.currentPoint,newPoint:b.currentPoint,cancelled:!0}):b._setX(d)}else f=Math.abs(h-b.startPageX),g=Math.abs(i-b.startPageY),f>5?(a.preventDefault(),a.stopPropagation(),b.moveReady=!0,b.element.addEventListener("click",b,!0)):g>5&&(b.scrolling=!1);b.basePageX=h}},d.prototype._touchEnd=function(){var a=this;if(a.element.removeEventListener(q.move[a._eventType],a,!1),b.removeEventListener(q.end[a._eventType],a,!1),a._eventType=null,a.scrolling){var c=-a.currentX/a._distance;c=a.directionX>0?Math.ceil(c):a.directionX<0?Math.floor(c):Math.round(c),0>c?c=0:c>a._maxPoint&&(c=a._maxPoint),a._touchAfter({moved:c!==a.currentPoint,originalPoint:a.currentPoint,newPoint:c,cancelled:!1}),a.moveToPoint(c)}},d.prototype._click=function(a){a.stopPropagation(),a.preventDefault()},d.prototype._touchAfter=function(a){var b=this;b.scrolling=!1,b.moveReady=!1,setTimeout(function(){b.element.removeEventListener("click",b,!0)},200),b._triggerEvent("fstouchend",!0,!1,a)},d.prototype._setStyle=function(a){var b=this,c=b.element.style;for(var d in a)g(c,d,a[d])},d.prototype._animate=function(a,b){var c=this,d=c.element,e=+new Date,f=parseInt(d.style.left,10),g=a,h=parseInt(b,10),i=function(a,b){return-(a/=b)*(a-2)},j=setInterval(function(){var a,b,c=new Date-e;c>h?(clearInterval(j),b=g):(a=i(c,h),b=a*(g-f)+f),d.style.left=b+"px"},10)},d.prototype.destroy=function(){var a=this;p.forEach(function(b){a.element.removeEventListener(q.start[b],a,!1)})},d.prototype._getTranslate=function(a){var b=this;return b.use3d?"translate3d("+a+"px, 0, 0)":"translate("+a+"px, 0)"},d.prototype._triggerEvent=function(a,c,d,e){var f=this,g=b.createEvent("Event");if(g.initEvent(a,c,d),e)for(var h in e)g[h]=e[h];return f.element.dispatchEvent(g)},a.Flipsnap=d}(window,window.document),KISSY.add("gallery/flipsnap/1.0/index",function(){return window.Flipsnap},{requires:["gallery/jquery-adapter/1.0/"]});